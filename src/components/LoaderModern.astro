---
// Componente Loader con animación de texto - Solo página de inicio
import squares from '../assets/squares.PNG';
import { Image } from 'astro:assets';
---

<div id="loader" class="fixed inset-0 z-[9999] bg-white flex items-center justify-center overflow-hidden">
  <!-- Content -->
  <div class="relative z-10 text-center flex flex-col items-center gap-6">
    <!-- Logo Image Animation -->
    <div class="logo-container w-24 h-24 md:w-32 md:h-32">
      <Image 
        src={squares} 
        alt="Galicia Arquitectura Logo" 
        class="w-full h-full object-contain logo-animation"
      />
    </div>

    <!-- Logo/Title Animation -->
    <div class="space-y-2 sm:space-y-4">
      <!-- GALICIA - Grande -->
      <h1 class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-bold text-gray-900 tracking-tight">
        <span class="inline-block">
          <span class="letter-animation" style="animation-delay: 0.1s">G</span>
          <span class="letter-animation" style="animation-delay: 0.2s">A</span>
          <span class="letter-animation" style="animation-delay: 0.3s">L</span>
          <span class="letter-animation" style="animation-delay: 0.4s">I</span>
          <span class="letter-animation" style="animation-delay: 0.5s">C</span>
          <span class="letter-animation" style="animation-delay: 0.6s">I</span>
          <span class="letter-animation" style="animation-delay: 0.7s">A</span>
        </span>
      </h1>
      
      <!-- Arquitectura - Más pequeño -->
      <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-light text-gray-700 tracking-wide">
        <span class="inline-block">
          <span class="letter-animation" style="animation-delay: 0.8s">A</span>
          <span class="letter-animation" style="animation-delay: 0.9s">r</span>
          <span class="letter-animation" style="animation-delay: 1.0s">q</span>
          <span class="letter-animation" style="animation-delay: 1.1s">u</span>
          <span class="letter-animation" style="animation-delay: 1.2s">i</span>
          <span class="letter-animation" style="animation-delay: 1.3s">t</span>
          <span class="letter-animation" style="animation-delay: 1.4s">e</span>
          <span class="letter-animation" style="animation-delay: 1.5s">c</span>
          <span class="letter-animation" style="animation-delay: 1.6s">t</span>
          <span class="letter-animation" style="animation-delay: 1.7s">u</span>
          <span class="letter-animation" style="animation-delay: 1.8s">r</span>
          <span class="letter-animation" style="animation-delay: 1.9s">a</span>
        </span>
      </h2>
    </div>
  </div>
</div>

<style>
  /* Logo Animation */
  .logo-animation {
    opacity: 0;
    transform: scale(0.8) rotate(-90deg);
    animation: logoReveal 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @keyframes logoReveal {
    0% {
      opacity: 0;
      transform: scale(0.8) rotate(-90deg);
    }
    100% {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }
  }

  /* Letter Animation */
  .letter-animation {
    display: inline-block;
    opacity: 0;
    transform: translateY(30px) rotateX(90deg);
    animation: letterReveal 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  }

  @keyframes letterReveal {
    0% {
      opacity: 0;
      transform: translateY(30px) rotateX(90deg);
    }
    100% {
      opacity: 1;
      transform: translateY(0) rotateX(0);
    }
  }

  /* Prevent scroll during loader */
  body.loader-active {
    overflow: hidden;
    position: fixed;
    width: 100%;
    height: 100%;
  }

  /* Loader fade out */
  .loader-fade-out {
    animation: fadeOut 0.5s ease-out forwards;
  }

  @keyframes fadeOut {
    0% {
      opacity: 1;
    }
    100% {
      opacity: 0;
      visibility: hidden;
    }
  }
</style>

<script>
  // Control del loader y scroll - Solo para página de inicio
  document.addEventListener('DOMContentLoaded', function() {
    const loader = document.getElementById('loader');
    const body = document.body;
    
    // Solo ejecutar si el loader existe
    if (!loader) return;
    
    // Prevenir scroll durante el loader
    body.classList.add('loader-active');
    
    // Tiempo total de animación: 2.5 segundos (más rápido)
    setTimeout(() => {
      // Agregar clase de fade out
      loader.classList.add('loader-fade-out');
      
      // Esperar a que termine el fade out y habilitar scroll
      setTimeout(() => {
        loader.style.display = 'none';
        body.classList.remove('loader-active');
        
        // Emitir evento de que el loader terminó
        window.dispatchEvent(new CustomEvent('loaderComplete'));
      }, 500);
    }, 2500);
  });

  // Prevenir scroll con teclas durante el loader
  document.addEventListener('keydown', function(e) {
    if (document.body.classList.contains('loader-active')) {
      if ([32, 33, 34, 35, 36, 37, 38, 39, 40].includes(e.keyCode)) {
        e.preventDefault();
        return false;
      }
    }
  });

  // Prevenir scroll con rueda del mouse durante el loader
  document.addEventListener('wheel', function(e) {
    if (document.body.classList.contains('loader-active')) {
      e.preventDefault();
      return false;
    }
  }, { passive: false });

  // Prevenir touch scroll en móviles durante el loader
  document.addEventListener('touchmove', function(e) {
    if (document.body.classList.contains('loader-active')) {
      e.preventDefault();
      return false;
    }
  }, { passive: false });
</script>
